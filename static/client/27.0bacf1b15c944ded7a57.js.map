{"version":3,"sources":["webpack:///./mattermost-redux/actions/timezone.js","webpack:///./utils/webapp_connector.js","webpack:///./components/logged_in/logged_in.jsx","webpack:///./components/logged_in/index.js"],"names":["Object","defineProperty","exports","value","autoUpdateTimezone","require","_users","_timezone","_users2","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","obj","configurable","writable","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","err","undefined","deviceTimezone","_ref","regeneratorRuntime","mark","_callee","dispatch","getState","currentUer","currentTimezone","newTimezoneExists","timezone","updatedUser","wrap","_callee$","_context","prev","next","getCurrentUser","getUserTimezone","id","automaticTimezone","useAutomaticTimezone","manualTimezone","updateMe","stop","_x","_x2","window","webappConnector","active","on","removeListener","emit","store","BACKSPACE_CHAR","LoggedIn","React","PureComponent","constructor","props","userIsActive","manual","currentUser","WebSocketClient","userUpdateActiveStatus","root","document","getElementById","className","isValidState","componentDidMount","WebSocketActions","enableTimezone","actions","getBrowserTimezone","$","off","cookie","indexOf","viewChannel","currentChannelId","addEventListener","onFocusListener","onBlurListener","handleUserActivityUpdates","UserAgent","addClass","attr","GlobalActions","encodeURIComponent","location","pathname","mouseOver","ev","type","removeClass","closest","find","e","which","is","preventDefault","componentWillUnmount","removeEventListener","render","mfaRequired","showTermsOfService","children","PropTypes","string","bool","isRequired","shape","func","mapStateToProps","state","ownProps","license","getLicense","config","getConfig","shouldShowTermsOfService","getCurrentChannelId","checkIfMFARequired","match","url","ExperimentalTimezone","mapDispatchToProps","bindActionCreators","connect"],"mappings":"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","file":"27.0bacf1b15c944ded7a57.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.autoUpdateTimezone = autoUpdateTimezone;\n\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.promise\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _users = require(\"../selectors/entities/users\");\n\nvar _timezone = require(\"../selectors/entities/timezone\");\n\nvar _users2 = require(\"./users\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction autoUpdateTimezone(deviceTimezone\n/*: string*/\n) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(dispatch\n      /*: DispatchFunc*/\n      , getState\n      /*: GetStateFunc*/\n      ) {\n        var currentUer, currentTimezone, newTimezoneExists, timezone, updatedUser;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                currentUer = (0, _users.getCurrentUser)(getState());\n                currentTimezone = (0, _timezone.getUserTimezone)(getState(), currentUer.id);\n                newTimezoneExists = currentTimezone.automaticTimezone !== deviceTimezone;\n\n                if (currentTimezone.useAutomaticTimezone && newTimezoneExists) {\n                  timezone = {\n                    useAutomaticTimezone: 'true',\n                    automaticTimezone: deviceTimezone,\n                    manualTimezone: currentTimezone.manualTimezone\n                  };\n                  updatedUser = _objectSpread({}, currentUer, {\n                    timezone: timezone\n                  });\n                  (0, _users2.updateMe)(updatedUser)(dispatch, getState);\n                }\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }()\n  );\n}","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\n/**\r\n * Create a placeholder webappConnector if one doesn't exist. Likely means we're not running in the desktop client.\r\n */\r\nif (!window.webappConnector) {\r\n    window.webappConnector = {\r\n        active: false,\r\n        on: () => { }, //eslint-disable-line no-empty-function\r\n        removeListener: () => { }, //eslint-disable-line no-empty-function\r\n        emit: () => { }, //eslint-disable-line no-empty-function\r\n    };\r\n}\r\n\r\n/**\r\n* Returns a reference to the webappConnector if available, or a placeholder object to silently ignore any interaction\r\n*/\r\nexport const webappConnector = window.webappConnector;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport $ from 'jquery';\r\nimport PropTypes from 'prop-types';\r\nimport React from 'react';\r\nimport {Redirect} from 'react-router';\r\nimport {viewChannel} from 'mattermost-redux/actions/channels';\r\n\r\nimport * as GlobalActions from 'actions/global_actions.jsx';\r\nimport * as WebSocketActions from 'actions/websocket_actions.jsx';\r\nimport * as UserAgent from 'utils/user_agent.jsx';\r\nimport LoadingScreen from 'components/loading_screen.jsx';\r\nimport {getBrowserTimezone} from 'utils/timezone.jsx';\r\nimport store from 'stores/redux_store.jsx';\r\nimport {webappConnector} from 'utils/webapp_connector';\r\nimport WebSocketClient from 'client/web_websocket_client.jsx';\r\n\r\nconst dispatch = store.dispatch;\r\nconst getState = store.getState;\r\n\r\nconst BACKSPACE_CHAR = 8;\r\n\r\nexport default class LoggedIn extends React.PureComponent {\r\n    static propTypes = {\r\n        currentUser: PropTypes.object,\r\n        currentChannelId: PropTypes.string,\r\n        children: PropTypes.object,\r\n        mfaRequired: PropTypes.bool.isRequired,\r\n        enableTimezone: PropTypes.bool.isRequired,\r\n        actions: PropTypes.shape({\r\n            autoUpdateTimezone: PropTypes.func.isRequired,\r\n        }).isRequired,\r\n        showTermsOfService: PropTypes.bool.isRequired,\r\n    }\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        const root = document.getElementById('root');\r\n        if (root) {\r\n            root.className += ' channel-view';\r\n        }\r\n    }\r\n\r\n    isValidState() {\r\n        return this.props.currentUser != null;\r\n    }\r\n\r\n    componentDidMount() {\r\n        // Initialize websocket\r\n        WebSocketActions.initialize();\r\n\r\n        if (this.props.enableTimezone) {\r\n            this.props.actions.autoUpdateTimezone(getBrowserTimezone());\r\n        }\r\n\r\n        // Make sure the websockets close and reset version\r\n        $(window).on('beforeunload',\r\n            () => {\r\n                // Turn off to prevent getting stuck in a loop\r\n                $(window).off('beforeunload');\r\n                if (document.cookie.indexOf('MMUSERID=') > -1) {\r\n                    viewChannel('', this.props.currentChannelId || '')(dispatch, getState);\r\n                }\r\n                WebSocketActions.close();\r\n            }\r\n        );\r\n\r\n        // Listen for focused tab/window state\r\n        window.addEventListener('focus', this.onFocusListener);\r\n        window.addEventListener('blur', this.onBlurListener);\r\n\r\n        // Listen for user activity updates from external sources via the webapp connector\r\n        if (webappConnector.active) {\r\n            webappConnector.on('user-activity-update', this.handleUserActivityUpdates);\r\n        }\r\n\r\n        // Because current CSS requires the root tag to have specific stuff\r\n\r\n        // Device tracking setup\r\n        if (UserAgent.isIos()) {\r\n            $('body').addClass('ios');\r\n        } else if (UserAgent.isAndroid()) {\r\n            $('body').addClass('android');\r\n        }\r\n\r\n        if (!this.props.currentUser) {\r\n            $('#root').attr('class', '');\r\n            GlobalActions.emitUserLoggedOutEvent('/login?redirect_to=' + encodeURIComponent(this.props.location.pathname), true, false);\r\n        }\r\n\r\n        $('body').on('mouseenter mouseleave', ':not(.post-list__dynamic) .post', function mouseOver(ev) {\r\n            if (ev.type === 'mouseenter') {\r\n                $(this).prev('.date-separator, .new-separator').addClass('hovered--after');\r\n                $(this).next('.date-separator, .new-separator').addClass('hovered--before');\r\n            } else {\r\n                $(this).prev('.date-separator, .new-separator').removeClass('hovered--after');\r\n                $(this).next('.date-separator, .new-separator').removeClass('hovered--before');\r\n            }\r\n        });\r\n\r\n        $('body').on('mouseenter mouseleave', '.search-item__container .post', function mouseOver(ev) {\r\n            if (ev.type === 'mouseenter') {\r\n                $(this).closest('.search-item__container').find('.date-separator').addClass('hovered--after');\r\n                $(this).closest('.search-item__container').next('div').find('.date-separator').addClass('hovered--before');\r\n            } else {\r\n                $(this).closest('.search-item__container').find('.date-separator').removeClass('hovered--after');\r\n                $(this).closest('.search-item__container').next('div').find('.date-separator').removeClass('hovered--before');\r\n            }\r\n        });\r\n\r\n        $('body').on('mouseenter mouseleave', ':not(.post-list__dynamic) .post.post--comment.same--root', function mouseOver(ev) {\r\n            if (ev.type === 'mouseenter') {\r\n                $(this).prev('.date-separator, .new-separator').addClass('hovered--comment');\r\n                $(this).next('.date-separator, .new-separator').addClass('hovered--comment');\r\n            } else {\r\n                $(this).prev('.date-separator, .new-separator').removeClass('hovered--comment');\r\n                $(this).next('.date-separator, .new-separator').removeClass('hovered--comment');\r\n            }\r\n        });\r\n\r\n        // Prevent backspace from navigating back a page\r\n        $(window).on('keydown.preventBackspace', (e) => {\r\n            if (e.which === BACKSPACE_CHAR && !$(e.target).is('input, textarea')) {\r\n                e.preventDefault();\r\n            }\r\n        });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        WebSocketActions.close();\r\n\r\n        $('body').off('click.userpopover');\r\n        $('body').off('mouseenter mouseleave', '.post');\r\n        $('body').off('mouseenter mouseleave', '.post.post--comment.same--root');\r\n\r\n        $('.modal').off('show.bs.modal');\r\n\r\n        $(window).off('keydown.preventBackspace');\r\n\r\n        window.removeEventListener('focus', this.onFocusListener);\r\n        window.removeEventListener('blur', this.onBlurListener);\r\n\r\n        webappConnector.removeListener('user-activity-update', this.handleUserActivityUpdates);\r\n    }\r\n\r\n    render() {\r\n        if (!this.isValidState()) {\r\n            return <LoadingScreen/>;\r\n        }\r\n\r\n        if (this.props.mfaRequired) {\r\n            if (this.props.location.pathname !== '/mfa/setup') {\r\n                return <Redirect to={'/mfa/setup'}/>;\r\n            }\r\n        } else if (this.props.location.pathname === '/mfa/confirm') {\r\n            // Nothing to do. Wait for MFA flow to complete before prompting TOS.\r\n        } else if (this.props.showTermsOfService) {\r\n            if (this.props.location.pathname !== '/terms_of_service') {\r\n                return <Redirect to={'/terms_of_service?redirect_to=' + encodeURIComponent(this.props.location.pathname)}/>;\r\n            }\r\n        }\r\n\r\n        return this.props.children;\r\n    }\r\n\r\n    onFocusListener() {\r\n        GlobalActions.emitBrowserFocus(true);\r\n    }\r\n\r\n    onBlurListener() {\r\n        GlobalActions.emitBrowserFocus(false);\r\n    }\r\n\r\n    handleUserActivityUpdates = ({userIsActive, manual}) => {\r\n        if (!this.props.currentUser) {\r\n            return;\r\n        }\r\n\r\n        // update the server with the users current away status\r\n        WebSocketClient.userUpdateActiveStatus(userIsActive, manual);\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport {autoUpdateTimezone} from 'mattermost-redux/actions/timezone';\r\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getLicense, getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCurrentUser, shouldShowTermsOfService} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {checkIfMFARequired} from 'utils/route';\r\n\r\nimport LoggedIn from './logged_in.jsx';\r\n\r\nfunction mapStateToProps(state, ownProps) {\r\n    const license = getLicense(state);\r\n    const config = getConfig(state);\r\n    const showTermsOfService = shouldShowTermsOfService(state);\r\n\r\n    return {\r\n        currentUser: getCurrentUser(state),\r\n        currentChannelId: getCurrentChannelId(state),\r\n        mfaRequired: checkIfMFARequired(getCurrentUser(state), license, config, ownProps.match.url),\r\n        enableTimezone: config.ExperimentalTimezone === 'true',\r\n        showTermsOfService,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            autoUpdateTimezone,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LoggedIn);\r\n"],"sourceRoot":""}